<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>游戏王卡片制作器</title>
    <meta http-equiv="Content-Security-Policy" content="script-src 'self' 'unsafe-inline';"/>
    <script>window.$ = window.jQuery = require('jquery');</script>
    <link href="./static/bootstrap.min.css" rel="stylesheet">
    <link href="./static/bootstrap-select.min.css" rel="stylesheet">
    <link href="./static/common.css" rel="stylesheet">
    <link href="./static/jcrop.css" rel="stylesheet">
    <link href="./static/index.css" rel="stylesheet">

    <script src="./static/bootstrap.min.js"></script>
    <script src="./static/bootstrap-select.min.js"></script>
    <script src="./static/jcrop.js"></script>
    <script src="./card/card.js"></script>
    <script src="./static/index.js"></script>
    <script src="./static/env.js"></script>
</head>
<body>
<div id="space" style="position: absolute; z-index: -1;"></div>
<!--<div class="main-box">-->
<div class="main-box" style="color: white; position: absolute; z-index: 0;">
    <div class="card-box">
        <canvas id="card" style="width: 542px; height: 790px; margin-left: 16px; margin-top: 16px; border-radius: 8px;"></canvas>
        <div class="prop-line" style="margin-left: 16px; width: 540px;">
            <button class="btn btn-primary" onclick="newCard();">新建卡片</button>
            <button class="btn btn-primary" onclick="openCard();">打开卡片</button>
            <button class="btn btn-primary" onclick="saveCard();">保存卡片</button>
            <button class="btn btn-primary" onclick="exportCardImage();">导出卡图</button>
            <button class="btn btn-danger" style="float: right; margin-top: 4px;" onclick="showAbout();">关于</button>
        </div>
    </div>
    <div class="info-box">
        <table style="border: none">
            <tr style="height: 40px;">
                <td style="width: 70px;"><b>卡片语言</b></td>
                <td style="width: 220px"><select id="selLanguage" class="selectpicker" onchange="onLanguageChange();">
                    <option value="cn2" selected>繁体中文</option>
                    <option value="cn">简体中文</option>
                    <option value="jp">日文</option>
                    <option value="jp2">日文注音</option>
                    <option value="en">英文</option>
                </select></td>
                <td></td>
            </tr>
            <tr style="height: 40px;">
                <td style="width: 70px;"><b>卡片名称</b></td>
                <td style="width: 220px"><input id="txtCardName" type="text" class="form-control" oninput="onInputCardName();"></td>
                <td></td>
            </tr>
            <tr style="height: 40px;">
                <td style="width: 70px;"><b>卡名颜色</b></td>
                <td colspan="2">
                    <button id="btnColor0" class="btn" onclick="onNameColorClicked(0);">黑</button>
                    <button id="btnColor1" class="btn" onclick="onNameColorClicked(1);">白</button>
                    <button id="btnColor2" class="btn" onclick="onNameColorClicked(2);">金</button>
                    <button id="btnColor3" class="btn" onclick="onNameColorClicked(3);">红</button>
                    <button id="btnColor4" class="btn" onclick="onNameColorClicked(4);">自定义</button>
                    <label class="prop-label-short">
                        <input id="txtNameColor" type="text" class="form-control">
                    </label>
                </td>
            </tr>
            <tr style="height: 40px;">
                <td style="width: 70px;"><b>卡片密码</b></td>
                <td style="width: 220px"><input id="txtCardPassword" type="text" class="form-control" oninput="onInputCardPassword();"></td>
                <td>&nbsp;<button class="btn btn-info" onclick="onRandomCodeGen();">随机生成</button></td>
            </tr>
            <tr style="height: 40px;">
                <td style="width: 70px;"><b>卡片图案</b></td>
                <td style="width: 220px">
                    <button class="btn btn-dark" onclick="selectCardImage();">选择</button>
                    <button class="btn btn-dark" onclick="cleanImage();">清除</button>
                    <img id="imgCard" src="./card/mold/flash.jpg" style="width: 500px; height: auto; display: none;" onload="onLoadCardImage();">
                </td>
                <td></td>
            </tr>
            <tr style="height: 40px;">
                <td style="width: 70px;"><b>卡片类型</b></td>
                <td colspan="2">
                    <button id="btnType0" class="btn" onclick="onCardTypeClicked(0);">怪兽</button>
                    <button id="btnType1" class="btn" onclick="onCardTypeClicked(1);">魔法</button>
                    <button id="btnType2" class="btn" onclick="onCardTypeClicked(2);">陷阱</button>
                </td>
            </tr>
        </table>

        <div id="divMonster">
            <table style="border: none">
                <tr style="height: 40px;">
                    <td style="width: 70px;"><b>怪兽类型</b></td>
                    <td>
                        <select id="selMonsterType2" class="selectpicker" onchange="onMonsterType2Changed();">
                            <option value="tc" selected>通常</option>
                            <option value="xg">效果</option>
                            <option value="ys">仪式</option>
                            <option value="rh">融合</option>
                            <option value="tt">同调</option>
                            <option value="cl">超量</option>
                            <option value="lj">链接</option>
                            <option value="tk">代币</option>
                        </select>
                        <select id="selMonsterType3" class="selectpicker" onchange="onMonsterType3Changed();">
                            <option value="" selected>无</option>
                            <option value="tc">通常</option>
                            <option value="tz">调整</option>
                            <option value="ec">二重</option>
                            <option value="lh">灵魂</option>
                            <option value="fz">反转</option>
                            <option value="ts">特殊召唤</option>
                            <option value="tm">同盟</option>
                            <option value="kt">卡通</option>
                            <option value="lb">灵摆</option>
                        </select>
                        <select id="selMonsterType4" class="selectpicker" onchange="onMonsterType4Changed();">
                            <option value="" selected>无</option>
                            <option value="tc">通常</option>
                            <option value="tz">调整</option>
                            <option value="ec">二重</option>
                            <option value="lh">灵魂</option>
                            <option value="fz">反转</option>
                            <option value="ts">特殊召唤</option>
                            <option value="tm">同盟</option>
                            <option value="kt">卡通</option>
                        </select>
                    </td>
                </tr>
                <tr style="height: 40px;">
                    <td style="width: 70px;"><b>怪兽属性</b></td>
                    <td>
                        <button id="btnAttr0" class="btn" onclick="onMonsterAttributeClicked(0);">光</button>
                        <button id="btnAttr1" class="btn" onclick="onMonsterAttributeClicked(1);">暗</button>
                        <button id="btnAttr2" class="btn" onclick="onMonsterAttributeClicked(2);">风</button>
                        <button id="btnAttr3" class="btn" onclick="onMonsterAttributeClicked(3);">水</button>
                        <button id="btnAttr4" class="btn" onclick="onMonsterAttributeClicked(4);">炎</button>
                        <button id="btnAttr5" class="btn" onclick="onMonsterAttributeClicked(5);">地</button>
                        <button id="btnAttr6" class="btn" onclick="onMonsterAttributeClicked(6);">神</button>
                    </td>
                </tr>
                <tr style="height: 40px;">
                    <td style="width: 70px;"><b>等级阶级</b></td>
                    <td>
                        <button id="btnLv0" class="btn" onclick="onMonsterLevelClicked(0);">0</button>
                        <button id="btnLv1" class="btn" onclick="onMonsterLevelClicked(1);">1</button>
                        <button id="btnLv2" class="btn" onclick="onMonsterLevelClicked(2);">2</button>
                        <button id="btnLv3" class="btn" onclick="onMonsterLevelClicked(3);">3</button>
                        <button id="btnLv4" class="btn" onclick="onMonsterLevelClicked(4);">4</button>
                        <button id="btnLv5" class="btn" onclick="onMonsterLevelClicked(5);">5</button>
                        <button id="btnLv6" class="btn" onclick="onMonsterLevelClicked(6);">6</button>
                        <button id="btnLv7" class="btn" onclick="onMonsterLevelClicked(7);">7</button>
                        <button id="btnLv8" class="btn" onclick="onMonsterLevelClicked(8);">8</button>
                        <button id="btnLv9" class="btn" onclick="onMonsterLevelClicked(9);">9</button>
                        <button id="btnLv10" class="btn" onclick="onMonsterLevelClicked(10);">10</button>
                        <button id="btnLv11" class="btn" onclick="onMonsterLevelClicked(11);">11</button>
                        <button id="btnLv12" class="btn" onclick="onMonsterLevelClicked(12);">12</button>
                    </td>
                </tr>
                <tr style="height: 40px;">
                    <td style="width: 70px;"><b>怪兽种族</b></td>
                    <td>
                        <select id="selMonsterRace" class="selectpicker" onchange="onMonsterRaceChanged();">
                            <option value="0" selected>龙族</option>
                            <option value="1">战士族</option>
                            <option value="2">恶魔族</option>
                            <option value="3">魔法师族</option>
                            <option value="4">天使族</option>
                            <option value="5">不死族</option>
                            <option value="6">岩石族</option>
                            <option value="7">植物族</option>
                            <option value="8">昆虫族</option>
                            <option value="9">水族</option>
                            <option value="10">炎族</option>
                            <option value="11">雷族</option>
                            <option value="12">鱼族</option>
                            <option value="13">海龙族</option>
                            <option value="14">幻龙族</option>
                            <option value="15">恐龙族</option>
                            <option value="16">爬虫类族</option>
                            <option value="17">机械族</option>
                            <option value="18">兽族</option>
                            <option value="19">鸟兽族</option>
                            <option value="20">兽战士族</option>
                            <option value="21">念动力族</option>
                            <option value="22">电子界族</option>
                            <option value="23">幻神兽族</option>
                            <option value="24">创造神族</option>
                        </select>
                        <label class="prop-label-short">
                            <input id="txtCardRace" type="text" class="form-control" oninput="onInputCardRace();">
                        </label>
                    </td>
                </tr>
                <tr style="height: 40px;">
                    <td style="width: 70px;"><b>攻击守备</b></td>
                    <td>
                        <label class="prop-label-short">
                            <input id="txtCardAtk" type="text" class="form-control" oninput="onInputCardAtk();">
                        </label>
                        <label class="prop-label-short">
                            <input id="txtCardDef" type="text" class="form-control" oninput="onInputCardDef();">
                        </label>
                    </td>
                </tr>
            </table>

            <div id="divPendulum" style="height: 40px; line-height: 40px; display: none">
                <table style="border: none">
                    <tr style="height: 40px;">
                        <td style="width: 70px;"><b>灵摆刻度</b></td>
                        <td>
                            <label class="prop-label">
                                <input id="txtCardPScale" type="text" maxlength="2" class="form-control" value="1" oninput="onInputCardPScale();" onchange="onInputCardPScale();">
                            </label>
                        </td>
                    </tr>
                </table>
            </div>

            <div id="divPendulumEffect" style="margin-top: 2px;height: 100px; display: none">
                <table style="border: none">
                    <tr style="height: 40px;">
                        <td style="width: 70px;"><b>灵摆效果</b></td>
                        <td>
                            <label class="prop-label-long">
                                <textarea id="txtPEffect" class="form-control" style="resize: none; height: 100px;" oninput="onInputPEffect();"></textarea>
                            </label>
                        </td>
                    </tr>
                </table>
            </div>
            <div id="divLink" style=" height: 104px; display: none">
                <table style="border: none">
                    <tr style="height: 40px;">
                        <td style="width: 70px;"><b>链接方向</b></td>
                        <td>
                            <table style="border: none">
                                <tr style="height: 34px">
                                    <td style="width: 34px;">
                                        <button id="btnLink0" class="btn btn-dark prop-link-btn" onclick="onLinkArrowClicked(0);">↖</button>
                                    </td>
                                    <td style="width: 34px;">
                                        <button id="btnLink1" class="btn btn-dark prop-link-btn" onclick="onLinkArrowClicked(1);">↑</button>
                                    </td>
                                    <td style="width: 34px;">
                                        <button id="btnLink2" class="btn btn-dark prop-link-btn" onclick="onLinkArrowClicked(2);">↗</button>
                                    </td>
                                </tr>
                                <tr style="height: 34px">
                                    <td style="width: 34px;">
                                        <button id="btnLink3" class="btn btn-dark prop-link-btn" onclick="onLinkArrowClicked(3);">←</button>
                                    </td>
                                    <td style="width: 34px;"></td>
                                    <td style="width: 34px;">
                                        <button id="btnLink4" class="btn btn-dark prop-link-btn" onclick="onLinkArrowClicked(4);">→</button>
                                    </td>
                                </tr>
                                <tr style="height: 34px">
                                    <td style="width: 34px;">
                                        <button id="btnLink5" class="btn btn-dark prop-link-btn" onclick="onLinkArrowClicked(5);">↙</button>
                                    </td>
                                    <td style="width: 34px;">
                                        <button id="btnLink6" class="btn btn-dark prop-link-btn" onclick="onLinkArrowClicked(6);">↓</button>
                                    </td>
                                    <td style="width: 34px;">
                                        <button id="btnLink7" class="btn btn-dark prop-link-btn" onclick="onLinkArrowClicked(7);">↘</button>
                                    </td>
                                </tr>
                            </table>
                        </td>
                    </tr>
                </table>
            </div>
        </div>

        <div id="divSpell" style="display: none">
            <table style="border: none">
                <tr style="height: 40px;">
                    <td style="width: 70px;"><b>魔法类型</b></td>
                    <td>
                        <button id="btnSpell0" class="btn" onclick="onMagicTypeClicked(0);">通常</button>
                        <button id="btnSpell1" class="btn" onclick="onMagicTypeClicked(1);">永续</button>
                        <button id="btnSpell2" class="btn" onclick="onMagicTypeClicked(2);">装备</button>
                        <button id="btnSpell3" class="btn" onclick="onMagicTypeClicked(3);">速攻</button>
                        <button id="btnSpell4" class="btn" onclick="onMagicTypeClicked(4);">场地</button>
                        <button id="btnSpell5" class="btn" onclick="onMagicTypeClicked(5);">仪式</button>
                    </td>
                </tr>
            </table>
        </div>

        <div id="divTrap" style="display: none">
            <table style="border: none">
                <tr style="height: 40px;">
                    <td style="width: 70px;"><b>陷阱类型</b></td>
                    <td>
                        <button id="btnTrap0" class="btn" onclick="onTrapTypeClicked(0);">通常</button>
                        <button id="btnTrap1" class="btn" onclick="onTrapTypeClicked(1);">永续</button>
                        <button id="btnTrap2" class="btn" onclick="onTrapTypeClicked(2);">反击</button>
                    </td>
                </tr>
            </table>
        </div>

        <div class="prop-line" style="margin-top: 4px;height: 100px;">
            <span class="prop-name"><b>卡片效果</b></span>
            <label class="prop-label-long">
                <textarea id="txtEffect" class="form-control" style="resize: none; height: 100px;" oninput="onInputEffect();"></textarea>
            </label>
        </div>

        <div class="prop-line">
            <span class="prop-name"><b>所在卡包</b></span>
            <label class="prop-label">
                <input id="txtCardBag" type="text" class="form-control" oninput="onInputCardBag();">
            </label>
        </div>
        <div class="prop-line">
            <span class="prop-name"><b>版权文字</b></span>
            <label class="prop-label">
                <input id="txtCardCopyright" type="text" class="form-control" oninput="onInputCardCopyright();">
            </label>
        </div>
<!--        <div class="prop-line">-->
<!--            <span class="prop-name"><b>闪卡效果</b></span>-->
<!--            <label class="prop-label">-->
<!--                <input id="txtShining" type="number" value="0" min="0" max="1" step="0.1" class="form-control" oninput="onInputShining();">-->
<!--            </label>-->
<!--        </div>-->
    </div>
</div>

<div id="divImageSelector"></div>
<div id="divAbout"></div>
<div id="divEnvErr"></div>

<script type="text/javascript">
    // 调节 bootstrap 属性
    $('#selMonsterType2').selectpicker({width: '80px'});
    $('#selMonsterType3').selectpicker({width: '80px'});
    $('#selMonsterType4').selectpicker({width: '80px'});
    $('#selMonsterRace').selectpicker({width: '100px'});

    // 加载弹出页
    $('#divImageSelector').load('./popup/imageselector.html');
    $('#divAbout').load('./popup/about.html');
    $('#divEnvErr').load('./popup/enverr.html');

    // 渲染卡片到界面上
    newCard();

</script>
<script src='./static/bg/TweenMax.min.js'></script>
<script src="./static/bg/script.js"></script>
<script type="text/javascript">
    checkEnvironment();
</script>
</body>
</html>